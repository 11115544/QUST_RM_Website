# 环境配置与使用指南

按顺序完成下面步骤，即可在本地运行 Robomaster 战队管理网站。

---

## 第一步：安装 Node.js

1. 打开浏览器，访问：**https://nodejs.org/zh-cn**
2. 下载 **LTS（长期支持版）**，例如 “20.x.x LTS”。
3. 双击下载的安装包，一路 **“下一步”**，默认选项即可。
4. 安装完成后：
   - 按 `Win + R`，输入 `cmd` 回车，打开命令提示符；
   - 输入下面命令并回车，若显示版本号则说明安装成功：
   ```text
   node -v
   npm -v
   ```

若提示“不是内部或外部命令”，说明未加入环境变量，可重新安装 Node.js 并勾选 “Add to PATH”，或重启电脑后再试。

---

## 第二步：准备项目环境变量

1. 在项目文件夹 `QUST_RM_Website` 中，找到 **`.env.example`** 文件。
2. **复制** 该文件，并**重命名**为 **`.env`**（没有 .example，文件名就是 `.env`）。
3. 用记事本或 VS Code 打开 **`.env`**，修改这一行：
   ```text
   NEXTAUTH_SECRET="请改成任意一串随机字符"
   ```
   改成任意一串字符即可，例如：
   ```text
   NEXTAUTH_SECRET="qust-rm-2025-secret-key"
   ```
4. 其余可以不动：
   - `DATABASE_URL="file:./dev.db"` 表示使用 SQLite，**不需要再安装数据库**；
   - `NEXTAUTH_URL="http://localhost:3000"` 本地开发保持即可。

保存并关闭 `.env` 文件。

---

## 第三步：安装依赖并初始化数据库

1. 在 **资源管理器** 中进入项目文件夹：  
   `C:\Users\ASUS\Desktop\QUST_RM_Website`
2. 在**地址栏**输入 **`cmd`** 并回车，会在当前目录打开命令提示符。
3. 依次执行下面三条命令（每行输入后回车，等执行完再输入下一条）：

   ```bash
   npm install
   ```

   等待安装完成（可能需要几分钟）。

   ```bash
   npx prisma generate
   ```

   再执行：

   ```bash
   npx prisma db push
   ```

   若没有报错，说明数据库已初始化完成。

---

## 第四步：启动网站

在**同一个**命令提示符窗口里执行：

```bash
npm run dev
```

看到类似 “Ready in xxx ms” 或 “Local: http://localhost:3000” 后，打开浏览器访问：

**http://localhost:3000**

即可看到网站首页。  
未登录时可浏览「战队简介」「荣誉展示」「新人招募」等对外页面；注册并登录后可进入「工作台」使用内部功能。

---

## 常见问题

**1. 执行 `npm install` 时报错或很慢**

- 可能是网络问题，可尝试切换网络或使用手机热点。
- 或使用国内镜像后再执行 `npm install`：
  ```bash
  npm config set registry https://registry.npmmirror.com
  npm install
  ```

**2. 提示 “找不到 .env” 或 “DATABASE_URL”**

- 确认已在项目根目录创建了 **`.env`** 文件（由 `.env.example` 复制并重命名）。
- 确认 `.env` 里有 `DATABASE_URL="file:./dev.db"` 和 `NEXTAUTH_SECRET="一串字符"`。

**3. 想用 PostgreSQL 而不是 SQLite**

- 需要先安装 PostgreSQL，并创建好一个数据库。
- 在 `.env` 里把 `DATABASE_URL` 改成类似：
  ```text
  DATABASE_URL="postgresql://用户名:密码@localhost:5432/数据库名"
  ```
- 同时需要把 `prisma/schema.prisma` 里的 `provider = "sqlite"` 改回 `provider = "postgresql"`，并把相关字段类型按 PostgreSQL 要求改回（见 README 或需求文档）。

**4. 如何停止网站**

- 在运行 `npm run dev` 的命令提示符窗口里按 **`Ctrl + C`**。

**5. 下次如何再启动**

- 进入项目文件夹，在地址栏输入 `cmd` 回车，执行：
  ```bash
  npm run dev
  ```
  再访问 http://localhost:3000 即可。

---

## 步骤小结

| 步骤 | 操作 |
|------|------|
| 1 | 安装 Node.js（从 nodejs.org 下载 LTS 版） |
| 2 | 复制 `.env.example` 为 `.env`，并修改 `NEXTAUTH_SECRET` |
| 3 | 在项目目录打开 cmd，执行 `npm install` → `npx prisma generate` → `npx prisma db push` |
| 4 | 执行 `npm run dev`，浏览器打开 http://localhost:3000 |

按上述步骤操作后即可完成环境配置并本地使用网站。
